\section{ABSTRACT}

We develop an integrated solution for incorporating ``digital twins” of real buildings into existing SCADA systems, which enables real-time prediction and advanced control. 
These digital twins are either EnergyPlus (E+) or data-driven (D+) building models, whose input and output variables are mapped to analogous real building OPC tags and track the real-time operation of the building.
An E+ digital twin can be used to provide predictions of the building’s performance in different weather, usage, and energy pricing scenarios, which allows for accurate assessment of different control strategies. 
However, it is not suitable for optimization and predictive control due to its complexity. 
We develop scalable D+ digital twin based on Gaussian Processes (GP) for accurate prediction and advanced control. 
%A GP-based Optimal Experiment Design method is implemented for designing functional tests on and selecting experiment data from the building to efficiently learn a D+ model of it. 
A D+ digital twin is much easier, faster, and less expensive to train than developing and tuning an EnergyPlus model, while still providing power forecasts and being suitable for control. 
Data-driven model predictive control (DPC) optimizes control inputs of the predictive D+ model for energy curtailment with thermal comfort guarantees in demand response applications. 
The DPC controller is integrated into the SCADA environment, demonstrating real-time in-the-loop control of E+ and D+ digital twins. 
%We demonstrate with real building data that D+ achieves prediction accuracy of 96-98\% and control performance with maximum 2\% error.
